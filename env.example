# HyperFleet Landing Zone Adapter - Environment Variables
# Copy to .env and customize for local development
#
# Usage:
#   source .env
#   ./run-local.sh

# =============================================================================
# GCP Project & GKE Cluster
# =============================================================================
export GCP_PROJECT_ID="your-gcp-project-id"
export GKE_CLUSTER_NAME="your-cluster-name"
export GKE_CLUSTER_REGION="us-central1"  # or use GKE_CLUSTER_ZONE for zonal clusters

# Kubeconfig path (ensures adapter uses kubeconfig instead of in-cluster config)
export KUBECONFIG="${HOME}/.kube/config"

# =============================================================================
# Pub/Sub Configuration
# =============================================================================
export BROKER_TOPIC="hyperfleet-adapter-topic"
export BROKER_SUBSCRIPTION_ID="hyperfleet-adapter-landing-zone-subscription"
export SUBSCRIBER_PARALLELISM="1"

# =============================================================================
# RabbitMQ Configuration (alternative to GCP Pub/Sub)
# =============================================================================
# Set broker.type to "rabbitmq" in broker.yaml to use RabbitMQ instead of Pub/Sub
export RABBITMQ_URL="amqp://user:pass@localhost:5672/"

# =============================================================================
# HyperFleet API Configuration
# =============================================================================
export HYPERFLEET_API_BASE_URL="https://api.hyperfleet.example.com"
export HYPERFLEET_API_VERSION="v1"

# =============================================================================
# Adapter Configuration (optional - defaults set in run-local.sh)
# =============================================================================
# Task config file path (default: ./charts/configs/adapter-landing-zone.yaml)
# export HYPERFLEET_TASK_CONFIG="./charts/configs/adapter-landing-zone.yaml"
# For GCP validation testing:
# export HYPERFLEET_TASK_CONFIG="./tmp/adapter-fake-validation-gcp.yaml"

# =============================================================================
# Logging Configuration (optional - defaults set in run-local.sh)
# =============================================================================
# Log level: debug, info, warn, error (default: debug for local dev)
# export LOG_LEVEL="debug"
# Log format: text, json (default: text)
# export LOG_FORMAT="text"
# Log output: stdout, stderr (default: stderr)
# export LOG_OUTPUT="stderr"

# =============================================================================
# GCP Authentication
# =============================================================================
# The Go SDK uses Application Default Credentials (ADC), NOT gcloud CLI auth.
#
# RECOMMENDED: Use service account key file
export GOOGLE_APPLICATION_CREDENTIALS="/path/to/service-account-key.json"
#
# How to create a service account key:
#   1. Create service account (if not exists):
#      gcloud iam service-accounts create hyperfleet-adapter-local \
#        --project="$GCP_PROJECT_ID" \
#        --display-name="HyperFleet Adapter Local Dev"
#
#   2. Grant Pub/Sub permissions:
#      gcloud projects add-iam-policy-binding "$GCP_PROJECT_ID" \
#        --member="serviceAccount:hyperfleet-adapter-local@${GCP_PROJECT_ID}.iam.gserviceaccount.com" \
#        --role="roles/pubsub.subscriber"
#
#   3. Create and download key file:
#      gcloud iam service-accounts keys create ./sa-key.json \
#        --iam-account="hyperfleet-adapter-local@${GCP_PROJECT_ID}.iam.gserviceaccount.com"
#
#   4. Set the path above:
#      export GOOGLE_APPLICATION_CREDENTIALS="./sa-key.json"
#
# ⚠️  WARNING: Using "gcloud auth application-default login" will override
#    your default credentials and may block other applications using ADC from a different project.
#
# Note: gcloud CLI auth (gcloud auth login) is separate and won't work for the adapter.
